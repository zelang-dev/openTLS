<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   $OpenBSD: tls_config_set_protocols.3,v 1.12 2023/07/02 06:37:27 beck Exp $
  
   Copyright (c) 2014 Ted Unangst <tedu@openbsd.org>
   Copyright (c) 2015, 2016 Joel Sing <jsing@openbsd.org>
   Copyright (c) 2015 Bob Beck <beck@openbsd.org>
  
   Permission to use, copy, modify, and distribute this software for any
   purpose with or without fee is hereby granted, provided that the above
   copyright notice and this permission notice appear in all copies.
  
   THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
   WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
   MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
   ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
   WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
   ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
   OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
   -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>TLS_CONFIG_SET_PROTOCOLS(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">TLS_CONFIG_SET_PROTOCOLS(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">TLS_CONFIG_SET_PROTOCOLS(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">tls_config_set_protocols</code>,
    <code class="Nm">tls_config_parse_protocols</code>,
    <code class="Nm">tls_config_set_alpn</code>,
    <code class="Nm">tls_config_set_ciphers</code>,
    <code class="Nm">tls_config_set_dheparams</code>,
    <code class="Nm">tls_config_set_ecdhecurves</code>,
    <code class="Nm">tls_config_prefer_ciphers_client</code>,
    <code class="Nm">tls_config_prefer_ciphers_server</code> &#x2014;
    <span class="Nd">TLS protocol and cipher selection</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><code class="In">#include
  &lt;<a class="In">tls.h</a>&gt;</code></p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_protocols</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">uint32_t protocols</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_parse_protocols</code>(<var class="Fa">uint32_t
    *protocols</var>, <var class="Fa">const char *protostr</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_alpn</code>(<var class="Fa">struct tls_config
    *config</var>, <var class="Fa">const char *alpn</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_ciphers</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *ciphers</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_dheparams</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *params</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_ecdhecurves</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *curves</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">tls_config_prefer_ciphers_client</code>(<var class="Fa" style="white-space: nowrap;">struct
    tls_config *config</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">tls_config_prefer_ciphers_server</code>(<var class="Fa" style="white-space: nowrap;">struct
    tls_config *config</var>);</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">These functions modify a configuration by setting parameters. The
    configuration options apply to both clients and servers, unless noted
    otherwise.</p>
<p class="Pp" id="tls_config_set_protocols"><a class="permalink" href="#tls_config_set_protocols"><code class="Fn">tls_config_set_protocols</code></a>()
    specifies which versions of the TLS protocol may be used. Possible values
    are the bitwise OR of:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li id="TLS_PROTOCOL_TLSv1_2"><a class="permalink" href="#TLS_PROTOCOL_TLSv1_2"><code class="Dv">TLS_PROTOCOL_TLSv1_2</code></a></li>
  <li id="TLS_PROTOCOL_TLSv1_3"><a class="permalink" href="#TLS_PROTOCOL_TLSv1_3"><code class="Dv">TLS_PROTOCOL_TLSv1_3</code></a></li>
</ul>
<p class="Pp">Additionally, the values
    <code class="Dv">TLS_PROTOCOL_TLSv1</code> (TLSv1.2, TLSv1.3),
    <code class="Dv">TLS_PROTOCOLS_ALL</code> (all supported protocols) and
    <code class="Dv">TLS_PROTOCOLS_DEFAULT</code> (TLSv1.2 and TLSv1.3) may be
    used.</p>
<p class="Pp" id="tls_config_parse_protocols">The
    <a class="permalink" href="#tls_config_parse_protocols"><code class="Fn">tls_config_parse_protocols</code></a>()
    utility function parses a protocol string and returns the corresponding
    value via the <var class="Ar">protocols</var> argument. This value can then
    be passed to the <code class="Fn">tls_config_set_protocols</code>()
    function. The protocol string is a comma or colon separated list of
    keywords. Valid keywords are:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt id="tlsv1.2"><a class="permalink" href="#tlsv1.2"><code class="Dv">tlsv1.2</code></a></dt>
  <dd style="width: auto;">&#x00A0;</dd>
  <dt id="tlsv1.3"><a class="permalink" href="#tlsv1.3"><code class="Dv">tlsv1.3</code></a></dt>
  <dd style="width: auto;">&#x00A0;</dd>
  <dt id="all"><a class="permalink" href="#all"><code class="Dv">all</code></a></dt>
  <dd>(all supported protocols)</dd>
  <dt id="default"><a class="permalink" href="#default"><code class="Dv">default</code></a></dt>
  <dd>(an alias for <code class="Dv">secure</code>)</dd>
  <dt id="legacy"><a class="permalink" href="#legacy"><code class="Dv">legacy</code></a></dt>
  <dd>(an alias for <code class="Dv">all</code>)</dd>
  <dt id="secure"><a class="permalink" href="#secure"><code class="Dv">secure</code></a></dt>
  <dd>(currently TLSv1.2 and TLSv1.3)</dd>
</dl>
</div>
<p class="Pp">If a value has a negative prefix (in the form of a leading
    exclamation mark) then it is removed from the list of available protocols,
    rather than being added to it.</p>
<p class="Pp" id="tls_config_set_alpn"><a class="permalink" href="#tls_config_set_alpn"><code class="Fn">tls_config_set_alpn</code></a>()
    sets the ALPN protocols that are supported. The alpn string is a comma
    separated list of protocols, in order of preference.</p>
<p class="Pp" id="tls_config_set_ciphers"><a class="permalink" href="#tls_config_set_ciphers"><code class="Fn">tls_config_set_ciphers</code></a>()
    sets the list of ciphers that may be used. Lists of ciphers are specified by
    name, and the permitted names are:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li id="secure~2"><a class="permalink" href="#secure~2"><code class="Dv">secure</code></a>
      (or alias <code class="Dv">default</code>)</li>
  <li id="compat"><a class="permalink" href="#compat"><code class="Dv">compat</code></a></li>
  <li id="legacy~2"><a class="permalink" href="#legacy~2"><code class="Dv">legacy</code></a></li>
  <li id="insecure"><a class="permalink" href="#insecure"><code class="Dv">insecure</code></a>
      (or alias <code class="Dv">all</code>)</li>
</ul>
<p class="Pp">Alternatively, libssl cipher strings can be specified. See the
    CIPHERS section of <a class="Xr">openssl(1)</a> for further information.</p>
<p class="Pp" id="tls_config_set_dheparams"><a class="permalink" href="#tls_config_set_dheparams"><code class="Fn">tls_config_set_dheparams</code></a>()
    specifies the parameters that will be used during Diffie-Hellman Ephemeral
    (DHE) key exchange. Possible values are:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li id="none"><a class="permalink" href="#none"><code class="Dv">none</code></a></li>
  <li id="auto"><a class="permalink" href="#auto"><code class="Dv">auto</code></a></li>
  <li id="legacy~3"><a class="permalink" href="#legacy~3"><code class="Dv">legacy</code></a></li>
</ul>
<p class="Pp">In <code class="Dv">auto</code> mode, the key size for the
    ephemeral key is automatically selected based on the size of the private key
    being used for signing. In <code class="Dv">legacy</code> mode, 1024 bit
    ephemeral keys are used. The default value is <code class="Dv">none</code>,
    which disables DHE key exchange.</p>
<p class="Pp" id="tls_config_set_ecdhecurves"><a class="permalink" href="#tls_config_set_ecdhecurves"><code class="Fn">tls_config_set_ecdhecurves</code></a>()
    specifies the names of the elliptic curves that may be used during Elliptic
    Curve Diffie-Hellman Ephemeral (ECDHE) key exchange. This is a comma
    separated list, given in order of preference. The special value of
    &quot;default&quot; will use the default curves (currently X25519, P-256 and
    P-384). This function replaces
    <a class="permalink" href="#tls_config_set_ecdhecurve"><code class="Fn" id="tls_config_set_ecdhecurve">tls_config_set_ecdhecurve</code></a>(),
    which is deprecated.</p>
<p class="Pp" id="tls_config_prefer_ciphers_client"><a class="permalink" href="#tls_config_prefer_ciphers_client"><code class="Fn">tls_config_prefer_ciphers_client</code></a>()
    prefers ciphers in the client's cipher list when selecting a cipher suite
    (server only). This is considered to be less secure than preferring the
    server's list.</p>
<p class="Pp" id="tls_config_prefer_ciphers_server"><a class="permalink" href="#tls_config_prefer_ciphers_server"><code class="Fn">tls_config_prefer_ciphers_server</code></a>()
    prefers ciphers in the server's cipher list when selecting a cipher suite
    (server only). This is considered to be more secure than preferring the
    client's list and is the default.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="RETURN_VALUES"><a class="permalink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
<p class="Pp">These functions return 0 on success or -1 on error.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">tls_config_ocsp_require_stapling(3)</a>,
    <a class="Xr">tls_config_set_session_id(3)</a>,
    <a class="Xr">tls_config_verify(3)</a>, <a class="Xr">tls_init(3)</a>,
    <a class="Xr">tls_load_file(3)</a></p>
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
<p class="Pp"><code class="Fn">tls_config_set_ciphers</code>() appeared in
    <span class="Ux">OpenBSD 5.6</span> and got its final name in
    <span class="Ux">OpenBSD 5.7</span>.</p>
<p class="Pp"><code class="Fn">tls_config_set_protocols</code>(),
    <code class="Fn">tls_config_parse_protocols</code>(),
    <code class="Fn">tls_config_set_dheparams</code>(), and
    <code class="Fn">tls_config_set_ecdhecurve</code>() appeared in
    <span class="Ux">OpenBSD 5.7</span>,
    <code class="Fn">tls_config_prefer_ciphers_client</code>() and
    <code class="Fn">tls_config_prefer_ciphers_server</code>() in
    <span class="Ux">OpenBSD 5.9</span>, and
    <code class="Fn">tls_config_set_alpn</code>() in <span class="Ux">OpenBSD
    6.1</span>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp"><span class="An">Joel Sing</span>
    &lt;<a class="Mt" href="mailto:jsing@openbsd.org">jsing@openbsd.org</a>&gt;
    with contributions from
  <br/>
  <span class="An">Ted Unangst</span>
    &lt;<a class="Mt" href="mailto:tedu@openbsd.org">tedu@openbsd.org</a>&gt;
    (<code class="Fn">tls_config_set_ciphers</code>()) and
  <br/>
  <span class="An">Reyk Floeter</span>
    &lt;<a class="Mt" href="mailto:reyk@openbsd.org">reyk@openbsd.org</a>&gt;
    (<code class="Fn">tls_config_set_ecdhecurve</code>())</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">July 2, 2023</td>
    <td class="foot-os">Debian</td>
  </tr>
</table>
</body>
</html>
