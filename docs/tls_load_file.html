<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   $OpenBSD: tls_load_file.3,v 1.14 2022/01/01 02:18:28 jsg Exp $
  
   Copyright (c) 2014 Ted Unangst <tedu@openbsd.org>
   Copyright (c) 2015 Reyk Floeter <reyk@openbsd.org>
   Copyright (c) 2015 Bob Beck <beck@openbsd.org>
   Copyright (c) 2016, 2017 Joel Sing <jsing@openbsd.org>
  
   Permission to use, copy, modify, and distribute this software for any
   purpose with or without fee is hereby granted, provided that the above
   copyright notice and this permission notice appear in all copies.
  
   THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
   WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
   MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
   ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
   WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
   ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
   OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
   -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>TLS_LOAD_FILE(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">TLS_LOAD_FILE(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">TLS_LOAD_FILE(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">tls_load_file</code>,
    <code class="Nm">tls_unload_file</code>,
    <code class="Nm">tls_config_set_ca_file</code>,
    <code class="Nm">tls_config_set_ca_path</code>,
    <code class="Nm">tls_config_set_ca_mem</code>,
    <code class="Nm">tls_config_set_cert_file</code>,
    <code class="Nm">tls_config_set_cert_mem</code>,
    <code class="Nm">tls_config_set_crl_file</code>,
    <code class="Nm">tls_config_set_crl_mem</code>,
    <code class="Nm">tls_config_set_key_file</code>,
    <code class="Nm">tls_config_set_key_mem</code>,
    <code class="Nm">tls_config_set_ocsp_staple_mem</code>,
    <code class="Nm">tls_config_set_ocsp_staple_file</code>,
    <code class="Nm">tls_config_set_keypair_file</code>,
    <code class="Nm">tls_config_set_keypair_mem</code>,
    <code class="Nm">tls_config_set_keypair_ocsp_file</code>,
    <code class="Nm">tls_config_set_keypair_ocsp_mem</code>,
    <code class="Nm">tls_config_add_keypair_file</code>,
    <code class="Nm">tls_config_add_keypair_ocsp_mem</code>,
    <code class="Nm">tls_config_add_keypair_ocsp_file</code>,
    <code class="Nm">tls_config_add_keypair_mem</code>,
    <code class="Nm">tls_config_clear_keys</code>,
    <code class="Nm">tls_config_set_verify_depth</code>,
    <code class="Nm">tls_config_verify_client</code>,
    <code class="Nm">tls_config_verify_client_optional</code>,
    <code class="Nm">tls_default_ca_cert_file</code> &#x2014;
    <span class="Nd">TLS certificate and key configuration</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><code class="In">#include
  &lt;<a class="In">tls.h</a>&gt;</code></p>
<p class="Pp"><var class="Ft">uint8_t *</var>
  <br/>
  <code class="Fn">tls_load_file</code>(<var class="Fa">const char *file</var>,
    <var class="Fa">size_t *len</var>, <var class="Fa">char
  *password</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">tls_unload_file</code>(<var class="Fa">uint8_t *buf</var>,
    <var class="Fa">size_t len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_ca_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *ca_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_ca_path</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *ca_path</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_ca_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *cert</var>,
    <var class="Fa">size_t len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_cert_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *cert_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_cert_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *cert</var>,
    <var class="Fa">size_t len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_crl_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *crl_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_crl_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *crl</var>,
    <var class="Fa">size_t len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_key_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *key_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_key_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *key</var>,
    <var class="Fa">size_t len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_ocsp_staple_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *staple</var>,
    <var class="Fa">size_t len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_ocsp_staple_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char
  *staple_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_keypair_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *cert_file</var>,
    <var class="Fa">const char *key_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_keypair_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *cert</var>,
    <var class="Fa">size_t cert_len</var>, <var class="Fa">const uint8_t
    *key</var>, <var class="Fa">size_t key_len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_keypair_ocsp_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *cert_file</var>,
    <var class="Fa">const char *key_file</var>, <var class="Fa">const char
    *staple_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_keypair_ocsp_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *cert</var>,
    <var class="Fa">size_t cert_len</var>, <var class="Fa">const uint8_t
    *key</var>, <var class="Fa">size_t key_len</var>, <var class="Fa">const
    uint8_t *staple</var>, <var class="Fa">size_t staple_len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_add_keypair_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *cert_file</var>,
    <var class="Fa">const char *key_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_add_keypair_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *cert</var>,
    <var class="Fa">size_t cert_len</var>, <var class="Fa">const uint8_t
    *key</var>, <var class="Fa">size_t key_len</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_add_keypair_ocsp_file</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const char *cert_file</var>,
    <var class="Fa">const char *key_file</var>, <var class="Fa">const char
    *staple_file</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_add_keypair_ocsp_mem</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">const uint8_t *cert</var>,
    <var class="Fa">size_t cert_len</var>, <var class="Fa">const uint8_t
    *key</var>, <var class="Fa">size_t key_len</var>, <var class="Fa">const
    uint8_t *staple</var>, <var class="Fa">size_t staple_len</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">tls_config_clear_keys</code>(<var class="Fa" style="white-space: nowrap;">struct
    tls_config *config</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">tls_config_set_verify_depth</code>(<var class="Fa">struct
    tls_config *config</var>, <var class="Fa">int verify_depth</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">tls_config_verify_client</code>(<var class="Fa" style="white-space: nowrap;">struct
    tls_config *config</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">tls_config_verify_client_optional</code>(<var class="Fa" style="white-space: nowrap;">struct
    tls_config *config</var>);</p>
<p class="Pp"><var class="Ft">const char *</var>
  <br/>
  <code class="Fn">tls_default_ca_cert_file</code>(<var class="Fa" style="white-space: nowrap;">void</var>);</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><a class="permalink" href="#tls_load_file"><code class="Fn" id="tls_load_file">tls_load_file</code></a>()
    loads a certificate or key from disk into memory to be used with
    <code class="Fn">tls_config_set_ca_mem</code>(),
    <code class="Fn">tls_config_set_cert_mem</code>(),
    <code class="Fn">tls_config_set_crl_mem</code>() or
    <code class="Fn">tls_config_set_key_mem</code>(). A private key will be
    decrypted if the optional <var class="Ar">password</var> argument is
    specified.</p>
<p class="Pp" id="tls_unload_file"><a class="permalink" href="#tls_unload_file"><code class="Fn">tls_unload_file</code></a>()
    unloads the memory that was returned from an earlier
    <code class="Fn">tls_load_file</code>() call, ensuring that the memory
    contents is discarded.</p>
<p class="Pp" id="tls_default_ca_cert_file"><a class="permalink" href="#tls_default_ca_cert_file"><code class="Fn">tls_default_ca_cert_file</code></a>()
    returns the path of the file that contains the default root
  certificates.</p>
<p class="Pp" id="tls_config_set_ca_file"><a class="permalink" href="#tls_config_set_ca_file"><code class="Fn">tls_config_set_ca_file</code></a>()
    loads a file containing the root certificates.</p>
<p class="Pp" id="tls_config_set_ca_path"><a class="permalink" href="#tls_config_set_ca_path"><code class="Fn">tls_config_set_ca_path</code></a>()
    sets the path (directory) which should be searched for root
  certificates.</p>
<p class="Pp" id="tls_config_set_ca_mem"><a class="permalink" href="#tls_config_set_ca_mem"><code class="Fn">tls_config_set_ca_mem</code></a>()
    sets the root certificates directly from memory.</p>
<p class="Pp" id="tls_config_set_cert_file"><a class="permalink" href="#tls_config_set_cert_file"><code class="Fn">tls_config_set_cert_file</code></a>()
    loads a file containing the public certificate.</p>
<p class="Pp" id="tls_config_set_cert_mem"><a class="permalink" href="#tls_config_set_cert_mem"><code class="Fn">tls_config_set_cert_mem</code></a>()
    sets the public certificate directly from memory.</p>
<p class="Pp" id="tls_config_set_crl_file"><a class="permalink" href="#tls_config_set_crl_file"><code class="Fn">tls_config_set_crl_file</code></a>()
    loads a file containing the Certificate Revocation List (CRL).</p>
<p class="Pp" id="tls_config_set_crl_mem"><a class="permalink" href="#tls_config_set_crl_mem"><code class="Fn">tls_config_set_crl_mem</code></a>()
    sets the CRL directly from memory.</p>
<p class="Pp" id="tls_config_set_key_file"><a class="permalink" href="#tls_config_set_key_file"><code class="Fn">tls_config_set_key_file</code></a>()
    loads a file containing the private key.</p>
<p class="Pp" id="tls_config_set_key_mem"><a class="permalink" href="#tls_config_set_key_mem"><code class="Fn">tls_config_set_key_mem</code></a>()
    directly sets the private key from memory.</p>
<p class="Pp" id="tls_config_set_ocsp_staple_file"><a class="permalink" href="#tls_config_set_ocsp_staple_file"><code class="Fn">tls_config_set_ocsp_staple_file</code></a>()
    loads a file containing a DER-encoded OCSP response to be stapled during the
    TLS handshake.</p>
<p class="Pp" id="tls_config_set_ocsp_staple_mem"><a class="permalink" href="#tls_config_set_ocsp_staple_mem"><code class="Fn">tls_config_set_ocsp_staple_mem</code></a>()
    sets a DER-encoded OCSP response to be stapled during the TLS handshake from
    memory.</p>
<p class="Pp" id="tls_config_set_keypair_file"><a class="permalink" href="#tls_config_set_keypair_file"><code class="Fn">tls_config_set_keypair_file</code></a>()
    loads two files from which the public certificate and private key will be
    read.</p>
<p class="Pp" id="tls_config_set_keypair_mem"><a class="permalink" href="#tls_config_set_keypair_mem"><code class="Fn">tls_config_set_keypair_mem</code></a>()
    directly sets the public certificate and private key from memory.</p>
<p class="Pp" id="tls_config_set_keypair_ocsp_file"><a class="permalink" href="#tls_config_set_keypair_ocsp_file"><code class="Fn">tls_config_set_keypair_ocsp_file</code></a>()
    loads three files containing the public certificate, private key, and
    DER-encoded OCSP staple.</p>
<p class="Pp" id="tls_config_set_keypair_ocsp_mem"><a class="permalink" href="#tls_config_set_keypair_ocsp_mem"><code class="Fn">tls_config_set_keypair_ocsp_mem</code></a>()
    directly sets the public certificate, private key, and DER-encoded OCSP
    staple from memory.</p>
<p class="Pp" id="tls_config_add_keypair_file"><a class="permalink" href="#tls_config_add_keypair_file"><code class="Fn">tls_config_add_keypair_file</code></a>()
    adds an additional public certificate and private key from the specified
    files, used as an alternative certificate for Server Name Indication (server
    only).</p>
<p class="Pp" id="tls_config_add_keypair_mem"><a class="permalink" href="#tls_config_add_keypair_mem"><code class="Fn">tls_config_add_keypair_mem</code></a>()
    adds an additional public certificate and private key from memory, used as
    an alternative certificate for Server Name Indication (server only).</p>
<p class="Pp" id="tls_config_add_keypair_ocsp_file"><a class="permalink" href="#tls_config_add_keypair_ocsp_file"><code class="Fn">tls_config_add_keypair_ocsp_file</code></a>()
    adds an additional public certificate, private key, and DER-encoded OCSP
    staple from the specified files, used as an alternative certificate for
    Server Name Indication (server only).</p>
<p class="Pp" id="tls_config_add_keypair_ocsp_mem"><a class="permalink" href="#tls_config_add_keypair_ocsp_mem"><code class="Fn">tls_config_add_keypair_ocsp_mem</code></a>()
    adds an additional public certificate, private key, and DER-encoded OCSP
    staple from memory, used as an alternative certificate for Server Name
    Indication (server only).</p>
<p class="Pp" id="tls_config_clear_keys"><a class="permalink" href="#tls_config_clear_keys"><code class="Fn">tls_config_clear_keys</code></a>()
    clears any secret keys from memory.</p>
<p class="Pp" id="tls_config_set_verify_depth"><a class="permalink" href="#tls_config_set_verify_depth"><code class="Fn">tls_config_set_verify_depth</code></a>()
    limits the number of intermediate certificates that will be followed during
    certificate validation.</p>
<p class="Pp" id="tls_config_verify_client"><a class="permalink" href="#tls_config_verify_client"><code class="Fn">tls_config_verify_client</code></a>()
    enables client certificate verification, requiring the client to send a
    certificate (server only).</p>
<p class="Pp" id="tls_config_verify_client_optional"><a class="permalink" href="#tls_config_verify_client_optional"><code class="Fn">tls_config_verify_client_optional</code></a>()
    enables client certificate verification, without requiring the client to
    send a certificate (server only).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="RETURN_VALUES"><a class="permalink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
<p class="Pp"><code class="Fn">tls_load_file</code>() returns
    <code class="Dv">NULL</code> on error or an out of memory condition.</p>
<p class="Pp">The other functions return 0 on success or -1 on error.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">tls_config_ocsp_require_stapling(3)</a>,
    <a class="Xr">tls_config_set_protocols(3)</a>,
    <a class="Xr">tls_config_set_session_id(3)</a>,
    <a class="Xr">tls_configure(3)</a>, <a class="Xr">tls_init(3)</a></p>
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
<p class="Pp"><code class="Fn">tls_config_set_ca_file</code>(),
    <code class="Fn">tls_config_set_ca_path</code>(),
    <code class="Fn">tls_config_set_cert_file</code>(),
    <code class="Fn">tls_config_set_cert_mem</code>(),
    <code class="Fn">tls_config_set_key_file</code>(),
    <code class="Fn">tls_config_set_key_mem</code>(), and
    <code class="Fn">tls_config_set_verify_depth</code>() appeared in
    <span class="Ux">OpenBSD 5.6</span> and got their final names in
    <span class="Ux">OpenBSD 5.7</span>.</p>
<p class="Pp"><code class="Fn">tls_load_file</code>(),
    <code class="Fn">tls_config_set_ca_mem</code>(), and
    <code class="Fn">tls_config_clear_keys</code>() appeared in
    <span class="Ux">OpenBSD 5.7</span>.</p>
<p class="Pp"><code class="Fn">tls_config_verify_client</code>() and
    <code class="Fn">tls_config_verify_client_optional</code>() appeared in
    <span class="Ux">OpenBSD 5.9</span>.</p>
<p class="Pp"><code class="Fn">tls_config_set_keypair_file</code>() and
    <code class="Fn">tls_config_set_keypair_mem</code>() appeared in
    <span class="Ux">OpenBSD 6.0</span>, and
    <code class="Fn">tls_config_add_keypair_file</code>() and
    <code class="Fn">tls_config_add_keypair_mem</code>() in
    <span class="Ux">OpenBSD 6.1</span>.</p>
<p class="Pp"><code class="Fn">tls_config_set_crl_file</code>() and
    <code class="Fn">tls_config_set_crl_mem</code>() appeared in
    <span class="Ux">OpenBSD 6.2</span>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp"><span class="An">Joel Sing</span>
    &lt;<a class="Mt" href="mailto:jsing@openbsd.org">jsing@openbsd.org</a>&gt;
    with contributions from
  <br/>
  <span class="An">Ted Unangst</span>
    &lt;<a class="Mt" href="mailto:tedu@openbsd.org">tedu@openbsd.org</a>&gt;
    and
  <br/>
  <span class="An">Bob Beck</span>
    &lt;<a class="Mt" href="mailto:beck@openbsd.org">beck@openbsd.org</a>&gt;.</p>
<p class="Pp"><code class="Fn">tls_load_file</code>() and
    <code class="Fn">tls_config_set_ca_mem</code>() were written by
  <br/>
  <span class="An">Reyk Floeter</span>
    &lt;<a class="Mt" href="mailto:reyk@openbsd.org">reyk@openbsd.org</a>&gt;.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">January 1, 2022</td>
    <td class="foot-os">Debian</td>
  </tr>
</table>
</body>
</html>
